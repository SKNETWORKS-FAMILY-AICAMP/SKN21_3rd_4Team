# ğŸ—ï¸ í”„ë¡œì íŠ¸ ì „ì²´ ì•„í‚¤í…ì²˜ êµ¬ì¡°

## ğŸ“ ì „ì²´ êµ¬ì¡°: 3ê³„ì¸µ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1ê³„ì¸µ: Presentation Layer (í”„ë¡ íŠ¸ì—”ë“œ)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  index.html (HTML/CSS/JavaScript)                    â”‚   â”‚
â”‚  â”‚  - ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤                                 â”‚   â”‚
â”‚  â”‚  - SSEë¡œ ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ë°›ê¸°                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ HTTP POST /chat/stream
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2ê³„ì¸µ: Application Layer (ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  app.py (Flask Web Server)                           â”‚   â”‚
â”‚  â”‚  - HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬                               â”‚   â”‚
â”‚  â”‚  - learning_agent() â†’ main() í˜¸ì¶œ                    â”‚   â”‚
â”‚  â”‚  - ì‘ë‹µ í¬ë§·íŒ… ë° SSE ìŠ¤íŠ¸ë¦¬ë°                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚ main() í•¨ìˆ˜ í˜¸ì¶œ
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3ê³„ì¸µ: Business Logic Layer (LangGraph ì›Œí¬í”Œë¡œìš°)          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  LangGraph (ì›Œí¬í”Œë¡œìš° ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°)                â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚  main.py: graph.invoke()                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  workflow.py: build_graph()                  â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                                                      â”‚   â”‚
â”‚  â”‚  ë…¸ë“œ ì‹¤í–‰ ìˆœì„œ (LangGraphê°€ ê´€ë¦¬):                  â”‚   â”‚
â”‚  â”‚  â‘  search_node      (ê²€ìƒ‰ ì‹¤í–‰)                    â”‚   â”‚
â”‚  â”‚  â‘¡ build_context    (ì»¨í…ìŠ¤íŠ¸ í¬ë§·íŒ…)              â”‚   â”‚
â”‚  â”‚  â‘¢ check_relevance  (ê´€ë ¨ì„± í‰ê°€ â†’ ë¶„ê¸°)           â”‚   â”‚
â”‚  â”‚  â‘£ analyst_node     (ìµœì¢… ë‹µë³€ ìƒì„±)               â”‚   â”‚
â”‚  â”‚     or web_search_node (ì™¸ë¶€ ê²€ìƒ‰)                 â”‚   â”‚
â”‚  â”‚     or no_data_node  (ê³ ì • ë©”ì‹œì§€)                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                       â”‚
                â†“                       â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  External Services   â”‚  â”‚   Vector Database    â”‚
    â”‚  - OpenAI GPT-4o     â”‚  â”‚   - Qdrant          â”‚
    â”‚  - Tavily Search     â”‚  â”‚   - Vector Search   â”‚
    â”‚  - Embeddings        â”‚  â”‚   - Metadata Filter â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ í•µì‹¬: LangGraphì˜ ì—­í• 

**LangGraph = ì›Œí¬í”Œë¡œìš° ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° (Workflow Orchestrator)**

LangGraphëŠ” **"ë…¸ë“œë“¤ì„ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•˜ê³  ìƒíƒœë¥¼ ê´€ë¦¬í•˜ëŠ” í”„ë ˆì„ì›Œí¬"**ì…ë‹ˆë‹¤.

### LangGraphê°€ í•˜ëŠ” ì¼:

1. **ë…¸ë“œ ìˆœì„œ ì œì–´**: ì–´ë–¤ ë…¸ë“œë¥¼ ë¨¼ì € ì‹¤í–‰í• ì§€ ê²°ì •
2. **ìƒíƒœ ê´€ë¦¬**: ê° ë…¸ë“œ ê°„ ë°ì´í„° ì „ë‹¬ (AgentState)
3. **ì¡°ê±´ë¶€ ë¶„ê¸°**: ì ìˆ˜ì— ë”°ë¼ ë‹¤ë¥¸ ê²½ë¡œë¡œ ì´ë™
4. **ì—ëŸ¬ ì²˜ë¦¬**: ë…¸ë“œ ì‹¤í–‰ ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬

### LangGraphê°€ í•˜ì§€ ì•ŠëŠ” ì¼:

- âŒ ì‹¤ì œ ê²€ìƒ‰ ìˆ˜í–‰ â†’ `search_agent.py`ê°€ ë‹´ë‹¹
- âŒ LLM í˜¸ì¶œ â†’ ê° ë…¸ë“œì—ì„œ ì§ì ‘ LangChainìœ¼ë¡œ í˜¸ì¶œ
- âŒ ì›¹ ì„œë²„ ì—­í•  â†’ Flaskê°€ ë‹´ë‹¹
- âŒ ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ â†’ ê° ë…¸ë“œì—ì„œ ì§ì ‘ Qdrant í´ë¼ì´ì–¸íŠ¸ ì‚¬ìš©

---

## ğŸ“¦ ê° ê³„ì¸µì˜ ì—­í• 

### 1ê³„ì¸µ: Frontend (templates/index.html)

**ì—­í• **: ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤

- ì‚¬ìš©ì ì§ˆë¬¸ ì…ë ¥ í¼
- Server-Sent Events (SSE)ë¡œ ì‹¤ì‹œê°„ ì‘ë‹µ ìˆ˜ì‹ 
- ì§„í–‰ ë‹¨ê³„, ë‹µë³€, ì¶”ì²œ ì§ˆë¬¸, ì°¸ê³  ìë£Œ í‘œì‹œ

**ê¸°ìˆ **:
- HTML/CSS/JavaScript
- SSE (EventSource API)
- Marked.js (ë§ˆí¬ë‹¤ìš´ ë Œë”ë§)
- Highlight.js (ì½”ë“œ í•˜ì´ë¼ì´íŒ…)

---

### 2ê³„ì¸µ: Flask Backend (app.py)

**ì—­í• **: HTTP API ì„œë²„

**ì£¼ìš” ê¸°ëŠ¥**:
1. HTTP ìš”ì²­ ë°›ê¸° (`POST /chat/stream`)
2. LangGraph ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ (`main()` í˜¸ì¶œ)
3. ê²°ê³¼ í¬ë§·íŒ… (ë§ˆí¬ë‹¤ìš´ í˜•ì‹ ë³€í™˜)
4. SSEë¡œ ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ

**í•µì‹¬ ì½”ë“œ**:
```python
@app.route('/chat/stream', methods=['POST'])
def chat_stream():
    # 1. ì‚¬ìš©ì ì§ˆë¬¸ ë°›ê¸°
    message = request.json.get('message')
    
    # 2. LangGraph ì›Œí¬í”Œë¡œìš° ì‹¤í–‰
    response = get_agent_response(mode, message)  # â†’ main() í˜¸ì¶œ
    
    # 3. SSEë¡œ ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ
    def generate():
        for step in response['steps']:
            yield f"data: {json.dumps({'type': 'step', 'data': step})}\n\n"
        for char in response['text']:
            yield f"data: {json.dumps({'type': 'char', 'data': char})}\n\n"
    
    return Response(generate(), mimetype='text/event-stream')
```

**Flaskì˜ ì—­í• **:
- âœ… HTTP ìš”ì²­/ì‘ë‹µ ì²˜ë¦¬
- âœ… ì„¸ì…˜ ê´€ë¦¬
- âœ… ì—ëŸ¬ í•¸ë“¤ë§
- âŒ ê²€ìƒ‰ ë¡œì§ (LangGraph ë…¸ë“œê°€ ë‹´ë‹¹)
- âŒ LLM í˜¸ì¶œ (LangGraph ë…¸ë“œê°€ ë‹´ë‹¹)

---

### 3ê³„ì¸µ: LangGraph Workflow (í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§)

**ì—­í• **: ì›Œí¬í”Œë¡œìš° ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜

#### 3-1. ì§„ì…ì : main.py

```python
def main(query: str):
    # LangGraph ê·¸ë˜í”„ ìƒì„±
    graph = build_graph()  # workflow.pyì—ì„œ ì •ì˜
    graph = graph.compile(checkpointer=MemorySaver())
    
    # ì´ˆê¸° ìƒíƒœ ì„¤ì •
    agent_state = AgentState(query=query, messages=[("human", query)])
    
    # ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ (ë™ê¸° ì‹¤í–‰)
    response = graph.invoke(agent_state, config=config)
    
    return response  # Flaskë¡œ ë°˜í™˜
```

#### 3-2. ì›Œí¬í”Œë¡œìš° ì •ì˜: workflow.py

```python
def build_graph() -> StateGraph:
    workflow = StateGraph(AgentState)
    
    # ë…¸ë“œ ë“±ë¡
    workflow.add_node("search_node", search_node)
    workflow.add_node("build_context", build_context)
    workflow.add_node("analyst_node", analyst_node)
    workflow.add_node("web_search_node", web_search_node)
    workflow.add_node("no_data_node", no_data_node)
    
    # ì—£ì§€ ì—°ê²° (ìˆœì„œ ì •ì˜)
    workflow.add_edge(START, "search_node")
    workflow.add_edge("search_node", "build_context")
    workflow.add_conditional_edges("build_context", check_relevance, {...})
    
    return workflow
```

#### 3-3. ë…¸ë“œ ì‹¤í–‰ ìˆœì„œ

```
START
  â†“
[search_node]          â† Qdrant ê²€ìƒ‰ (í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰)
  â†“                   
[build_context]        â† ê²€ìƒ‰ ê²°ê³¼ í¬ë§·íŒ…
  â†“
[check_relevance]      â† í‰ê·  ì ìˆ˜ ê³„ì‚° í›„ ë¶„ê¸°
  â†“
  â”œâ”€ í‰ê·  â‰¤ 0.3  â†’ [no_data_node]    â†’ END
  â”œâ”€ 0.3 < í‰ê·  â‰¤ 0.5 â†’ [web_search_node] â†’ [analyst_node] â†’ END
  â””â”€ í‰ê·  > 0.5  â†’ [analyst_node]    â†’ END
```

---

## ğŸ”§ ê° ë…¸ë“œì˜ ì‹¤ì œ êµ¬í˜„

### Node 1: search_node

**íŒŒì¼**: `src/agent/nodes/search_node.py`

```python
def search_node(state: AgentState):
    query = state['query']
    
    # 1. Router: ì§ˆë¬¸ ë¶„ì„ (LLM í˜¸ì¶œ)
    config = build_search_config(query)  # search_router.py
    
    # 2. Search Agent: ì‹¤ì œ ê²€ìƒ‰ (í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰)
    results = execute_dual_query_search(query)  # search_agent.py
    
    return {'search_results': results}
```

**ì‹¤ì œ ê¸°ìˆ  ìŠ¤íƒ**:
- LLM: LangChain + OpenAI GPT-4o-mini (ì§ˆë¬¸ ë¶„ì„)
- Vector DB: Qdrant í´ë¼ì´ì–¸íŠ¸ (ì§ì ‘ ì ‘ê·¼)
- ê²€ìƒ‰: í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰ (Vector + Keyword + BM25)

### Node 2: build_context

**íŒŒì¼**: `src/agent/nodes/search_node.py`

```python
def build_context(state: AgentState):
    results = state['search_results']
    
    # ê²€ìƒ‰ ê²°ê³¼ë¥¼ í…ìŠ¤íŠ¸ë¡œ í¬ë§·íŒ…
    context_parts = []
    for i, res in enumerate(results, 1):
        part = f"[Original {i}] ì¶œì²˜: {res['metadata']['source']}\n{res['content']}"
        context_parts.append(part)
    
    return {"context": "\n\n---\n\n".join(context_parts)}
```

**ì‹¤ì œ ê¸°ìˆ  ìŠ¤íƒ**:
- ìˆœìˆ˜ Python ë¬¸ìì—´ í¬ë§·íŒ…
- LangGraph ì—†ì´ë„ ì‹¤í–‰ ê°€ëŠ¥

### Node 3: check_relevance

**íŒŒì¼**: `src/agent/nodes/analyst_node.py`

```python
def check_relevance(state: AgentState):
    scores = [r['score'] for r in state['search_results']]
    avg_score = sum(scores) / len(scores)
    
    # ì¡°ê±´ë¶€ ë¶„ê¸°
    if avg_score <= 0.3:
        return "no_data_node"
    elif avg_score <= 0.5:
        return "web_search_node"
    else:
        return "analyst_node"
```

**ì‹¤ì œ ê¸°ìˆ  ìŠ¤íƒ**:
- ìˆœìˆ˜ Python ë¡œì§
- LangGraphì˜ ì¡°ê±´ë¶€ ë¶„ê¸° ê¸°ëŠ¥ í™œìš©

### Node 4: analyst_node

**íŒŒì¼**: `src/agent/nodes/analyst_node.py`

```python
def analyst_node(state: AgentState):
    # LLM í˜¸ì¶œ
    llm = ChatOpenAI(model="gpt-4o-mini", temperature=0)
    llm = llm.bind_tools([submit_analysis], tool_choice="submit_analysis")
    
    prompt = ChatPromptTemplate.from_messages([
        SystemMessagePromptTemplate.from_template(PROMPTS["ANALYSIS_SYSTEM_PROMPT"]),
        HumanMessagePromptTemplate.from_template("{query}")
    ])
    
    chain = prompt | llm
    response = chain.invoke(state)  # state['context']ì™€ state['query'] ì‚¬ìš©
    
    return {
        "analyst_results": [response],
        "suggested_questions": [...]
    }
```

**ì‹¤ì œ ê¸°ìˆ  ìŠ¤íƒ**:
- LangChain: LLM í˜¸ì¶œ ë° í”„ë¡¬í”„íŠ¸ ê´€ë¦¬
- OpenAI GPT-4o-mini: ë‹µë³€ ìƒì„±
- Pydantic: Structured Tool Calling

---

## ğŸ’¡ ì™œ LangGraphë¥¼ ì‚¬ìš©í•˜ëŠ”ê°€?

### LangGraph ì—†ì´ êµ¬í˜„í•œë‹¤ë©´:

```python
# ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰
def process_query(query):
    # 1. ê²€ìƒ‰
    results = search_node(query)
    
    # 2. ì»¨í…ìŠ¤íŠ¸ í¬ë§·íŒ…
    context = build_context(results)
    
    # 3. ê´€ë ¨ì„± í‰ê°€
    avg_score = check_relevance(results)
    
    # 4. ì¡°ê±´ë¶€ ë¶„ê¸° (ìˆ˜ë™)
    if avg_score <= 0.3:
        return no_data_node()
    elif avg_score <= 0.5:
        web_results = web_search_node(query)
        context += web_results
        return analyst_node(context, query)
    else:
        return analyst_node(context, query)
```

**ë¬¸ì œì **:
- âŒ ìƒíƒœ ê´€ë¦¬ê°€ ì–´ë ¤ì›€ (ë§¤ë²ˆ í•¨ìˆ˜ í˜¸ì¶œ ì‹œ ë°ì´í„° ì „ë‹¬)
- âŒ ë¶„ê¸° ë¡œì§ì´ ë³µì¡í•´ì§
- âŒ ê° ë‹¨ê³„ë¥¼ ì¬ì‚¬ìš©í•˜ê¸° ì–´ë ¤ì›€
- âŒ ëŒ€í™” ê¸°ë¡ ê´€ë¦¬ ì–´ë ¤ì›€ (MemorySaver ê¸°ëŠ¥ ì—†ìŒ)
- âŒ ë…¸ë“œ ê°„ ì˜ì¡´ì„± ê´€ë¦¬ ì–´ë ¤ì›€

### LangGraphë¥¼ ì‚¬ìš©í•˜ë©´:

```python
# ì„ ì–¸ì ìœ¼ë¡œ ì •ì˜
workflow = StateGraph(AgentState)
workflow.add_node("search_node", search_node)
workflow.add_node("build_context", build_context)
workflow.add_conditional_edges("build_context", check_relevance, {...})

# ìë™ìœ¼ë¡œ ì‹¤í–‰
response = graph.invoke(agent_state)
```

**ì¥ì **:
- âœ… ìƒíƒœê°€ ìë™ìœ¼ë¡œ ì „ë‹¬ë¨ (AgentState)
- âœ… ì¡°ê±´ë¶€ ë¶„ê¸°ê°€ ê¹”ë”í•¨
- âœ… ê° ë…¸ë“œë¥¼ ë…ë¦½ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- âœ… ëŒ€í™” ê¸°ë¡ ìë™ ê´€ë¦¬ (MemorySaver)
- âœ… ì‹œê°í™” ê°€ëŠ¥ (ë…¸ë“œ ê·¸ë˜í”„)
- âœ… í™•ì¥ ìš©ì´ (ìƒˆ ë…¸ë“œ ì¶”ê°€ ì‰¬ì›€)

---

## ğŸ“ ê²°ë¡ : ì „ì²´ êµ¬ì¡° ìš”ì•½

### 3ê³„ì¸µ êµ¬ì¡°

1. **Frontend (HTML/JS)**
   - ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤
   - SSEë¡œ ì‹¤ì‹œê°„ ì‘ë‹µ ìˆ˜ì‹ 

2. **Flask (Python Web Framework)**
   - HTTP API ì„œë²„
   - LangGraph ì›Œí¬í”Œë¡œìš° í˜¸ì¶œ
   - ì‘ë‹µ í¬ë§·íŒ… ë° ìŠ¤íŠ¸ë¦¬ë°

3. **LangGraph (Workflow Orchestrator)**
   - ë…¸ë“œ ìˆœì„œ ì œì–´
   - ìƒíƒœ ê´€ë¦¬ (AgentState)
   - ì¡°ê±´ë¶€ ë¶„ê¸°

### LangGraph ë‚´ë¶€ì˜ ì‹¤ì œ ë¡œì§

- **ê²€ìƒ‰**: Qdrant í´ë¼ì´ì–¸íŠ¸ ì§ì ‘ ì‚¬ìš©
- **LLM í˜¸ì¶œ**: LangChain ì‚¬ìš©
- **í•˜ì´ë¸Œë¦¬ë“œ ê²€ìƒ‰**: ìˆœìˆ˜ Python ì•Œê³ ë¦¬ì¦˜

### í•µì‹¬ í¬ì¸íŠ¸

**LangGraph = ì›Œí¬í”Œë¡œìš° í”„ë ˆì„ì›Œí¬ (ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°)**
- ë…¸ë“œ ì‹¤í–‰ ìˆœì„œ ê´€ë¦¬
- ìƒíƒœ ì „ë‹¬ ë° ê´€ë¦¬
- ì¡°ê±´ë¶€ ë¶„ê¸° ì²˜ë¦¬

**ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ = ê° ë…¸ë“œ**
- ê²€ìƒ‰ ë¡œì§: `search_agent.py`
- LLM í˜¸ì¶œ: `analyst_node.py`
- Vector DB ì ‘ê·¼: Qdrant í´ë¼ì´ì–¸íŠ¸ ì§ì ‘ ì‚¬ìš©

---

## ğŸ“Š ì „ì²´ ë°ì´í„° íë¦„

```
ì‚¬ìš©ì ì§ˆë¬¸ ì…ë ¥ (Frontend)
    â†“
HTTP POST /chat/stream (Flask)
    â†“
learning_agent() í•¨ìˆ˜ (app.py)
    â†“
main() í•¨ìˆ˜ í˜¸ì¶œ (main.py)
    â†“
graph.invoke() ì‹¤í–‰ (LangGraph)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LangGraph ì›Œí¬í”Œë¡œìš° ì‹¤í–‰           â”‚
â”‚                                     â”‚
â”‚  START                              â”‚
â”‚    â†“                                â”‚
â”‚  search_node                        â”‚
â”‚    â”œâ”€ search_router (LLM í˜¸ì¶œ)      â”‚
â”‚    â””â”€ search_agent (Qdrant ê²€ìƒ‰)    â”‚
â”‚    â†“                                â”‚
â”‚  build_context (í…ìŠ¤íŠ¸ í¬ë§·íŒ…)       â”‚
â”‚    â†“                                â”‚
â”‚  check_relevance (ì ìˆ˜ ê³„ì‚°)         â”‚
â”‚    â†“                                â”‚
â”‚  [ë¶„ê¸°]                             â”‚
â”‚    â”œâ”€ analyst_node (LLM í˜¸ì¶œ)       â”‚
â”‚    â”œâ”€ web_search_node (Tavily)      â”‚
â”‚    â””â”€ no_data_node (ê³ ì • ë©”ì‹œì§€)    â”‚
â”‚    â†“                                â”‚
â”‚  END                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
AgentState ë°˜í™˜ (main.py)
    â†“
ì‘ë‹µ í¬ë§·íŒ… (app.py)
    â†“
SSE ìŠ¤íŠ¸ë¦¬ë° (Flask)
    â†“
í™”ë©´ í‘œì‹œ (Frontend)
```

---

**ê²°ë¡ **: 
- **LangGraphëŠ” ì›Œí¬í”Œë¡œìš° ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°**ë¡œ, ë…¸ë“œë“¤ì˜ ì‹¤í–‰ ìˆœì„œì™€ ìƒíƒœë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤.
- **ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ ê° ë…¸ë“œ**ì—ì„œ êµ¬í˜„ë˜ë©°, LangChain, Qdrant, ìˆœìˆ˜ Python ë“± ë‹¤ì–‘í•œ ê¸°ìˆ ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
- **FlaskëŠ” HTTP API ì„œë²„** ì—­í• ë§Œ í•˜ë©°, LangGraphë¥¼ í˜¸ì¶œí•˜ê³  ê²°ê³¼ë¥¼ ìŠ¤íŠ¸ë¦¬ë°í•©ë‹ˆë‹¤.